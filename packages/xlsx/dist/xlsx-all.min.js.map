{"version":3,"sources":["../src/csStyle.js","../src/csBaseStyleElement.js","../src/csStyleBorder.js","../src/csStyleFill.js","../src/csStyleFormat.js","../src/csStyleFont.js","../src/csStyleAlign.js","../src/csStyleProtect.js","../src/csWorksheet.js","../src/csWorkbook.js"],"names":["UB","isServer","Error","Ext","define","statics","indexDefFormateDate","constructor","config","this","borders","XLSX","csStyleBorder","left","right","top","bottom","fills","csStyleFill","patternType","formats","csStyleFormat","fonts","csStyleFont","alignments","csStyleAlign","protects","csStyleProtect","elements","named","compiled","styleHashList","styleHashListIndex","defaultStyle","getStyle","code","compileSTemplate","cfg","out","push","format","font","fill","border","setformat","setfill","setborder","setalignment","setWrapText","setprotect","alignmentval","protectionval","setAdditionalAlignment","setVerticalAlign","setHorizontalAlign","join","compileTemplate","obj","formatsCnt","length","render","fontsCnt","fillsCnt","bordersCnt","elementsJoined","isDefined","setfont","alignment","protect","protectval","styleHash","getStyleHash","styleId","id","getDefDateStyle","DefDateStyle","csStyle","toString","context","alignmentsCnt","protectsCnt","startId","add","count","info","compile","element","extend","callParent","xkey","prop","colorN","hasOwnProperty","style","color","diagonal","fgColor","theme","tint","indexed","bgColor","st","csWorkbook","formatCode","escapeXML","bold","shadow","fontSize","name","family","scheme","underline","templateCompile","workBook","dataRows","nextRowNum","columnProperies","merge","diapason","minRowNum","minColNum","maxRowNum","maxColNum","applyIf","title","setActive","table","apply","substring","me","d","result","numAlpha","fixFirstColumn","mm","margins","header","footer","_","defaults","worksheetScale","orientation","xlWorksheets","file","contentTypes","unshift","props","xlRels","worksheets","getRowNum","setRowNum","rowNum","checkRowNum","addRow","template","rowConfig","type","valAsTagIs","useSharedString","isArray","undefined","width","numberColumnsWidth","setColsProperties","columnsSpan","rowsCount","height","cellCount","Array","each","cell","index","checkColNum","column","value","addString","isDate","convertDate","formula","cellStyle","rowSpan","addMerge","colFrom","rowFrom","colTo","rowTo","colSpan","res","isNumber","setOrientation","setWorksheetScale","scale","setFixForFirstColumn","numFmts","alphabet","i","t","Math","floor","charAt","alphaNum","s","indexOf","substr","input","Date","UTC","getTimezoneOffset","typeOf","call","match","toLowerCase","getAttr","n","replace","unescapeXML","fileCreator","lastModifiedBy","fileCreated","fileModified","windowHeight","windowWidth","protectStructure","protectWindows","compiledWorksheets","sharedStrings","sharedStringsArr","sharedStringIndex","sharedStringTotal","addWorkSheet","ws","csWorksheet","val","xl","zip","JSZip","folder","docProps","toISOString","compileWorksheets","contentTypesTab","activeWorksheet","generateAsync","compression","setCompression","worksheet","test","wb","defFont","borderFull","fstyle","fstyleborderFull","columnTemplate","toLog","writeFile","rData","window","open"],"mappings":"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","file":"xlsx-all.min.js","sourcesContent":["/*global XLSX*/\nif (UB.isServer){\n    // var Ext = require('Ext');\n  throw new Error('XLSX temporary unavailable on server side')\n}\n/**\n * Файл: XLSX.csStyle.js\n */\nExt.define('XLSX.csStyle', {\n   /*\n\trequires: UB.isServer ? null:[\n\t\t'XLSX.csStyleBorder',\n\t\t'XLSX.csStyleFill',\n\t\t'XLSX.csStyleFormat',\n\t\t'XLSX.csStyleFont',\n\t\t'XLSX.csStyleAlign',\n\t\t'XLSX.csStyleProtect',\n\t\t'XLSX.csBaseStyleElement'\n\t],\n    */\n\tstatics: {\n\t\tindexDefFormateDate: 14\n\t},\n\tconstructor: function(config) {\n\t\tconfig = config || {};\n\n\t\tthis.borders =  new XLSX.csStyleBorder( {left:{}, right:{}, top: {}, bottom:{} });\n\t\tthis.fills = new XLSX.csStyleFill( {patternType : 'none'});\n\t\tthis.formats = new XLSX.csStyleFormat();\n\t\tthis.fonts = new XLSX.csStyleFont();\n\t\tthis.alignments = new XLSX.csStyleAlign();\n\t\tthis.protects = new XLSX.csStyleProtect();\n\n\t\tthis.elements = [];\n\t\tthis.named = {};\n\t\tthis.compiled = [];\n\t\tthis.styleHashList = {};\n\t\tthis.styleHashListIndex = 0;\n\n\t\tthis.defaultStyle = this.getStyle({ code: \"defaultStyle\" });\n\t},\n\n\tcompileSTemplate: function(cfg){\n\n\t\tvar\n\t\t\tout = [];\n\t\tout.push('<xf numFmtId=\"', cfg.format, '\" fontId=\"', cfg.font, '\" fillId=\"', cfg.fill, '\" borderId=\"', cfg.border, '\" xfId=\"0\"');\n\t\tif (cfg.setformat === true){\n\t\t\tout.push(' applyNumberFormat=\"1\"');\n\t\t}\n\t\t//if (cfg.setfont === true){\n\t\t\tout.push(' applyFont=\"1\"');\n\t\t//}\n\t\tif (cfg.setfill === true){\n\t\t\tout.push(' applyFill=\"1\"');\n\t\t}\n\t\tif (cfg.setborder === true){\n\t\t\tout.push(' applyBorder=\"1\"');\n\t\t}\n\t\tif (cfg.setalignment === true || cfg.setWrapText === 1){\n\t\t\tout.push(' applyAlignment=\"1\"');\n\t\t}\n\t\tif (cfg.setprotect === true){\n\t\t\tout.push(' applyProtection=\"1\"');\n\t\t}\n\t\tout.push('>');\n\t\tif (cfg.setalignment === true){\n\t\t\tout.push(' ', cfg.alignmentval);\n\t\t}\n\t\tif (cfg.setprotect === true){\n\t\t\tout.push(' ', cfg.protectionval);\n\t\t}\n\n\t\tvar setAdditionalAlignment =\n\t\t\tcfg.setWrapText ||\n\t\t\tcfg.setVerticalAlign ||\n\t\t\tcfg.setHorizontalAlign;\n\n\t\tif (setAdditionalAlignment !== 0) {\n\t\t\tout.push(\"<alignment \");\n\t\t}\n\t\tif (cfg.setWrapText === 1) {\n\t\t\tout.push(' wrapText=\"1\" ');\n\t\t}\n\t\t//top, center, bottom (by default)\n\t\tif (cfg.setVerticalAlign !== 0) {\n\t\t\tout.push(' vertical=\"' + cfg.setVerticalAlign + '\" ');\n\t\t}\n\t\t//left (by default), center, right\n\t\tif (cfg.setHorizontalAlign !== 0) {\n\t\t\tout.push(' horizontal=\"' + cfg.setHorizontalAlign + '\" ');\n\t\t}\n\t\tif (setAdditionalAlignment !== 0) {\n\t\t\tout.push(\"/>\");\n\t\t}\n\n\t\tout.push('</xf>');\n\t\treturn out.join('');\n\t},\n\n\tcompileTemplate: function(obj){\n\t\tvar\n\t\t\tout = [];\n\n\t\tout.push(\n\t\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n',\n\t\t\t'<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\">'\n\t\t);\n\t\tif (obj.formatsCnt > 0){\n\t\t\tout.push('<numFmts count=\"', obj.formats.elements.length, '\">', obj.formats.render(), '</numFmts>');\n\t\t}\n\t\tif (obj.fontsCnt > 0){\n\t\t\tout.push('<fonts count=\"', obj.fonts.elements.length, '\">', obj.fonts.render(), '</fonts>');\n\t\t}\n\t\tif (obj.fillsCnt > 0){\n\t\t\tout.push('<fills count=\"', obj.fills.elements.length, '\">', obj.fills.render(), '</fills>');\n\t\t}\n\t\tif (obj.bordersCnt > 0){\n\t\t\tout.push('<borders count=\"', obj.borders.elements.length, '\">', obj.borders.render(), '</borders>');\n\t\t}\n\t\tout.push(\n\t\t\t'<cellStyleXfs count=\"1\">',\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/>',\n\t\t\t'</cellStyleXfs>',\n\t\t\t'<cellXfs count=\"', obj.compiled.length, '\">', obj.elementsJoined, '</cellXfs>',\n\t\t\t'<cellStyles count=\"1\">',\n\t\t\t\t'<cellStyle name=\"Обычный\" xfId=\"0\" builtinId=\"0\"/>',\n\t\t\t'</cellStyles>',\n\t\t\t'<dxfs count=\"0\"/>',\n\t\t\t'<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleLight16\"/>',\n\t\t\t'</styleSheet>'\n\t\t);\n\n\t\treturn out.join('');\n\n\t\t//'<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\">',\n        /*\n         this.tpl = Ext.create('Ext.XTemplate',\n         '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>',\n         '<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\">',\n         '<tpl if=\"formatsCnt &gt; 0\">',\n         '<numFmts count=\"{[values.formats.elements.length]}\">{[values.formats.render()]}</numFmts>',\n         '</tpl>',\n         '<tpl if=\"fontsCnt &gt; 0\">',\n         '<fonts count=\"{[values.fonts.elements.length]}\">{[values.fonts.render()]}</fonts>',\n         '</tpl>',\n         '<tpl if=\"fillsCnt &gt; 0\">',\n         '<fills count=\"{[values.fills.elements.length]}\">{[values.fills.render()]}</fills>',\n         '</tpl>',\n         '<tpl if=\"bordersCnt &gt; 0\">',\n         '<borders count=\"{[values.borders.elements.length]}\">{[values.borders.render()]}</borders>',\n         '</tpl>',\n         '<cellStyleXfs count=\"1\">',\n         '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/>',\n         '</cellStyleXfs>',\n         '<cellXfs count=\"{[values.compiled.length]}\">{elementsJoined}</cellXfs>',\n         '<cellStyles count=\"1\">',\n         '<cellStyle name=\"Обычный\" xfId=\"0\" builtinId=\"0\"/>',\n         '</cellStyles>',\n         '<dxfs count=\"0\"/>',\n         '<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleLight16\"/>',\n         '</styleSheet>'\n         );\n         this.tpl.compile();\n\t\t */\n\t\t//'<extLst><ext uri=\"\" xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\">',\n\t\t//    '<x14:slicerStyles defaultSlicerStyle=\"SlicerStyleLight1\"/></ext></extLst>',\n\t},\n\n\t/**\n\t * If style not exists add new.  Return style index\n\t * @param config\n\t *  @param {Number} [config.border] (optional) {@link XLSX.csStyle#borders.add} {@link XLSX.csStyleBorder#add}\n\t *  @param {Number} [config.fill] (optional) {@link XLSX.csStyle#fills.add} {@link XLSX.csStyleFill#add}\n\t *  @param {Number} [config.format] (optional) {@link XLSX.csStyle#formats.add} {@link XLSX.csStyleFormat#add}\n\t *  @param {Number} [config.font] (optional) {@link XLSX.csStyle#fonts.add} {@link XLSX.csStyleFont#add}\n\t *  @param {Number} [config.alignment] (optional) {@link XLSX.csStyle#alignments.add} {@link XLSX.csStyleAlign#add}\n\t *  @param {Number} [config.protect] (optional) {@link XLSX.csStyle#protects.add} {@link XLSX.csStyleProtect#add}\n\t *  @return {Number}\n\t */\n\tgetStyle: function(config) {\n\n\t\tvar cfg = config; //Ext.clone(config);\n\t\tcfg.setborder = Ext.isDefined(cfg.border);\n\t\tcfg.border = cfg.border || 0;\n\t\tcfg.setfill = Ext.isDefined(cfg.fill);\n\t\tcfg.fill = cfg.fill || 0;\n\t\tcfg.setformat = Ext.isDefined(cfg.format);\n\t\tcfg.format = cfg.format || 0;\n\t\tcfg.setfont = Ext.isDefined(cfg.font);\n\t\tcfg.font = cfg.font || 0;\n\t\tcfg.setalignment = Ext.isDefined(cfg.alignment);\n\t\tcfg.setWrapText = cfg.setWrapText || 0;\n\t\tcfg.setVerticalAlign = cfg.setVerticalAlign || 0;\n\t\tcfg.setHorizontalAlign = cfg.setHorizontalAlign || 0;\n\t\tcfg.alignment = cfg.alignment || 0;\n\t\tif (Ext.isDefined(cfg.alignment)){\n\t\t\tcfg.alignmentval = this.alignments.compiled[cfg.alignment];\n\t\t}\n\t\tcfg.setprotect = Ext.isDefined(cfg.protect);\n\t\tif (Ext.isDefined(cfg.protect)){\n\t\t\tcfg.protectval = this.protects.compiled[cfg.protect];\n\t\t}\n\t\tcfg.protect = cfg.protect || 0;\n\t\tvar styleHash = this.getStyleHash(cfg);\n\t\tvar styleId = this.styleHashList[styleHash];\n\t\tif (styleId){\n\t\t\treturn styleId;\n\t\t}\n\n\t\tcfg.id = this.styleHashList[styleHash] = this.styleHashListIndex;  // this.elements\n\t\tthis.styleHashListIndex++;\n\t\tthis.compiled.push( this.compileSTemplate(cfg) ); //this.tplXfs.apply(cfg)\n\t\tif(cfg.code){\n\t\t\tthis.named[cfg.code] = cfg.id;\n\t\t}\n\t\treturn cfg.id;\n\t},\n\n\tgetDefDateStyle: function(){\n\t\tif (!this.named.DefDateStyle){\n\t\t\tthis.getStyle({format: XLSX.csStyle.indexDefFormateDate, code: \"DefDateStyle\"});\n\t\t}\n\t\treturn this.named.DefDateStyle;\n\t},\n\n\t/**\n\t * @private\n\t * @param config\n\t * @return {String}\n\t */\n\tgetStyleHash: function(config){\n\t\treturn [\n\t\t\t!config.setborder ? \"#\" : config.border.toString(),\n\t\t\t!config.border ? \"#\" : config.border.toString(),\n\t\t\t!config.setfill ? \"#\" : config.fill.toString(),\n\t\t\t!config.setformat ? \"#\" : config.format.toString(),\n\t\t\t!config.setfont ? \"#\" : config.font.toString(),\n\t\t\t!config.setalignment ? \"#\" : config.alignment.toString(),\n\t\t\t!config.setprotect ? \"#\" : config.protect.toString(),\n\t\t\t!config.setWrapText ? \"#\" : config.setWrapText.toString(),\n\t\t\t!config.setVerticalAlign ? \"#\" : config.setVerticalAlign.toString(),\n\t\t\t!config.setHorizontalAlign ? \"#\" : config.setHorizontalAlign.toString()\n\t\t].join('_');\n\t},\n\n\t/**\n\t * @private\n\t * @param context\n\t * @return {String}\n\t */\n\trender: function(context) {\n\t\tthis.elementsJoined =  this.compiled.join('') ;\n\t\tthis.bordersCnt = this.borders.elements.length;\n\t\tthis.fillsCnt = this.fills.elements.length;\n\t\tthis.formatsCnt = this.formats.elements.length;\n\t\tthis.fontsCnt = this.fonts.elements.length;\n\t\tthis.alignmentsCnt = this.alignments.elements.length;\n\t\tthis.protectsCnt = this.protects;\n\n\n\t\treturn this.compileTemplate(this); // this.tpl.apply(this);\n\t}\n\n});","if (UB.isServer){\r\n    // var Ext = require('Ext');\r\n  throw new Error('XLSX temporary unavailable on server side')\r\n}\r\n/**\r\n * Файл: XLSX.csStyleElement.js\r\n */\r\nExt.define('XLSX.csBaseStyleElement', {\r\n    constructor: function(config) {\r\n        this.elements = [];\r\n        /**\r\n         * Associative array of element. (String code - Integer index) pair\r\n         * @type {Object}\r\n         */\r\n        this.named = {};\r\n        this.compiled = [];\r\n        this.startId = this.startId || 0;\r\n        if (config){\r\n            this.add(config);\r\n        }\r\n    },\r\n\r\n    render: function(){\r\n       return this.compiled.join('');\r\n    },\r\n\r\n    count: function(){\r\n        return  this.compiled.length;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param info\r\n     * @return {Number} Style element index\r\n     */\r\n    add: function(info) {\r\n        this.elements.push(info);\r\n        info.id = this.startId ;\r\n        this.startId++;\r\n        if (info.code){\r\n            this.named[info.code] = info.id;\r\n        }\r\n        this.compile(info);\r\n        return info.id;\r\n    },\r\n\r\n    compileTemplate: function(){\r\n        throw new Error('You must override function compileTemplate.');\r\n    },\r\n\r\n    compile: function(element){\r\n        this.compiled.push(this.compileTemplate(element) ); //tpl.apply(element)\r\n    }\r\n\r\n});\r\n\r\n","if (UB.isServer){\r\n    // var Ext = require('Ext');\r\n  throw new Error('XLSX temporary unavailable on server side')\r\n}\r\n/**\r\n * Registred border styles\r\n */\r\nExt.define('XLSX.csStyleBorder', {\r\n    extend: 'XLSX.csBaseStyleElement',\r\n\r\n    constructor: function(config) {\r\n        return this.callParent([config]);\r\n    },\r\n\r\n    compileTemplate: function(element){\r\n        var\r\n            out = [], xkey, prop, colorN;\r\n        out.push('<border>');\r\n        for( xkey in element ){\r\n            if (element.hasOwnProperty(xkey)){\r\n                prop = element[xkey];\r\n                if (xkey === 'id' ){\r\n                    continue;\r\n                }\r\n                out.push('<', xkey, ' ' );\r\n                if (prop.style) {\r\n                    out.push('style=\"', prop.style, '\" ');\r\n                } else {\r\n                    out.push('/');\r\n                }\r\n                out.push('>');\r\n                if (prop.style) {\r\n                    out.push('<color ');\r\n                    if (prop.color){\r\n                        for( colorN in prop.color ){\r\n                            if (prop.color.hasOwnProperty(colorN)){\r\n                                out.push(colorN, '=\"', prop.color[colorN], '\" ');\r\n                            }\r\n                        }\r\n                    } else {\r\n                        out.push('auto=\"1\" ');\r\n                    }\r\n                    out.push('/>');\r\n                    out.push('</', xkey, '>');\r\n                }\r\n            }\r\n        }\r\n        out.push('</border>');\r\n        return out.join('');\r\n        /*\r\n\r\n         this.tpl = Ext.create('Ext.XTemplate',\r\n         '<border>',\r\n         '<tpl foreach=\".\">',\r\n         '{% if (xkey == \"id\") continue; %}',\r\n         '<{$} ',\r\n         '<tpl if=\"style.length != 0\">',\r\n         'style=\"{style}\"',\r\n         '<tpl else>',\r\n         '/',\r\n         '</tpl>',\r\n         '>',\r\n         '<tpl if=\"style.length != 0\">',\r\n         '<color ',\r\n         '<tpl if=\"color.length != 0\">',\r\n         '<tpl for=\"color\">',\r\n         '{$}=\"{.}\"',\r\n         '</tpl>',\r\n         '<tpl else>',\r\n         'auto=\"1\"',\r\n         '</tpl>',\r\n         '/>',\r\n         '</{$}>',\r\n         '</tpl>',\r\n         '</tpl>',\r\n         '</border>'\r\n         );\r\n         this.tpl.compile();\r\n         */\r\n    },\r\n\r\n    /**\r\n     * add new border style info. Used for add new style.\r\n     * @param {Object} info\r\n     * @param {Object} [info.left] (optional)\r\n     * @param {String} [info.left.style] (optional) \"none\",\"thin\",\"medium\",\"dashed\",\"dotted\",\"thick\",\"double\",\"hair\",\"mediumDashed\",\"dashDot\",\"mediumDashDot\",\"dashDotDot\",\"mediumDashDotDot\",\"slantDashDot\"\r\n     * @param {String} [info.left.color] (optional) default=auto {rgb: 'FFFF0000}\r\n     * @param {Object} [info.right] (optional) like left\r\n     * @param {Object} [info.top] (optional) like left\r\n     * @param {Object} [info.bottom] (optional) like left\r\n     * @param {Object} [info.diagonal] (optional) like left\r\n     * @param {String} [info.code] (optional) for link code to index in associative array\r\n     * @return {Number} index\r\n     */\r\n    add: function(info) {\r\n        info = info || {};\r\n        info.left = info.left || {};\r\n        info.right = info.right || {};\r\n        info.top = info.top || {};\r\n        info.bottom = info.bottom || {};\r\n        info.diagonal = info.diagonal || {};\r\n        return this.callParent([info]);\r\n    }\r\n    //,\r\n\r\n\r\n    /**\r\n     * @private\r\n     * compile borders\r\n     * -----------------\r\n     * <border>\r\n     * <left style=\"medium\">\r\n     *    <color rgb=\"FFFF0000\"/>\r\n     * </left>\r\n     * <top/>\r\n     * <right style=\"thin\">\r\n     *   <color auto=\"1\"/>\r\n     * </right>\r\n     * </border>\r\n     */\r\n     /*\r\n    compile: function(){\r\n        this.compiled =  new Array(this.elements.length);\r\n\r\n        Ext.each(this.elements, function(fill, index) {\r\n            this.compiled[index] = this.compileTemplate(fill);    //tpl.apply(fill)\r\n        }, this);\r\n    }\r\n    */\r\n});\r\n","if (UB.isServer){\r\n    // var Ext = require('Ext');\r\n  throw new Error('XLSX temporary unavailable on server side')\r\n}\r\n/**\r\n * Registred fill styles\r\n */\r\nExt.define('XLSX.csStyleFill', {\r\n    extend: 'XLSX.csBaseStyleElement',\r\n\r\n    constructor: function(config) {\r\n        return this.callParent([config]);\r\n    },\r\n\r\n    compileTemplate: function(element){\r\n        var out = [];\r\n        out.push(\r\n            '<fill>',\r\n            '<patternFill patternType=\"', element.patternType, '\">'\r\n        );\r\n        if (element.fgColor){\r\n            out.push('<fgColor ');\r\n            if (element.fgColor.theme){\r\n               out.push('theme=\"', element.fgColor.theme + '', '\" ');\r\n            }\r\n            if (element.fgColor.tint){\r\n                out.push('tint=\"', element.fgColor.tint + '', '\" ');\r\n            }\r\n            if (element.fgColor.indexed){\r\n                out.push('indexed=\"', element.fgColor.indexed + '', '\" ');\r\n            }\r\n            out.push('/>');\r\n        }\r\n        if (element.bgColor){\r\n            out.push('<bgColor ');\r\n            if (element.bgColor.theme){\r\n                out.push('theme=\"', element.bgColor.theme + '', '\" ');\r\n            }\r\n            if (element.bgColor.tint){\r\n                out.push('tint=\"', element.bgColor.tint + '', '\" ');\r\n            }\r\n            if (element.bgColor.indexed){\r\n                out.push('indexed=\"', element.bgColor.indexed + '', '\" ');\r\n            }\r\n            out.push('/>');\r\n        }\r\n        out.push(\r\n          '</patternFill>',\r\n          '</fill>'\r\n        );\r\n        return out.join('');\r\n        /*\r\n         this.tpl = Ext.create('Ext.XTemplate',\r\n         '<fill>',\r\n         '<patternFill patternType=\"{patternType}\">',\r\n         '<tpl if=\"fgColor.length !== 0\">',\r\n         '<fgColor ',\r\n         '<tpl if=\"fgColor.theme.length !== 0\">',\r\n         'theme=\"{fgColor.theme}\" ',\r\n         '</tpl>',\r\n         '<tpl if=\"fgColor.tint.length !== 0\">',\r\n         'tint=\"{fgColor.tint}\" ',\r\n         '</tpl>',\r\n         '<tpl if=\"fgColor.indexed.length !== 0\">',\r\n         'indexed=\"{fgColor.indexed}\" ',\r\n         '</tpl>',\r\n         '/>',\r\n         '</tpl>',\r\n         '<tpl if=\"bgColor.length !== 0\">',\r\n         '<bgColor ',\r\n         '<tpl if=\"bgColor.theme.length !== 0\">',\r\n         'theme=\"{bgColor.theme}\" ',\r\n         '</tpl>',\r\n         '<tpl if=\"bgColor.tint.length !== 0\">',\r\n         'tint=\"{bgColor.tint}\" ',\r\n         '</tpl>',\r\n         '<tpl if=\"bgColor.indexed.length !== 0\">',\r\n         'indexed=\"{bgColor.indexed}\" ',\r\n         '</tpl>',\r\n         '/>',\r\n         '</tpl>',\r\n         '</patternFill>',\r\n         '</fill>'\r\n         );\r\n         this.tpl.compile();\r\n\r\n        */\r\n    },\r\n\r\n    /**\r\n     * add new fill style info. Used for add new style.\r\n     * @param {Object} info\r\n     * @param {Object} [info.fgColor] (optional)\r\n     * @param {String} [info.fgColor.theme] (optional)\r\n     * @param {Number} [info.fgColor.tint] (optional)\r\n     * @param {Number} [info.fgColor.indexed] (optional)\r\n     * @param {Object} [info.bgColor] (optional)\r\n     * @param {String} [info.bgColor.theme] (optional)\r\n     * @param {Number} [info.bgColor.tint] (optional)\r\n     * @param {Number} [info.bgColor.indexed] (optional)\r\n     * @return {Number} index\r\n     */\r\n    add: function(info) {\r\n        return this.callParent([info]);\r\n    }\r\n\r\n\r\n});\r\n","/*global XLSX */\r\n\r\nif (UB.isServer){\r\n    // var Ext = require('Ext');\r\n  throw new Error('XLSX temporary unavailable on server side')\r\n}\r\n\r\n/**\r\n * Registred format styles\r\n */\r\nExt.define('XLSX.csStyleFormat', {\r\n    extend: 'XLSX.csBaseStyleElement',\r\n\r\n    constructor: function(config) {\r\n        /*\r\n        this.tpl = Ext.create('Ext.XTemplate',\r\n            '<numFmt numFmtId=\"{id}\" formatCode=\"{formatCode}\"/>'\r\n        );\r\n        this.tpl.compile();\r\n        */\r\n        this.startId = 164;\r\n        this.callParent([config]);\r\n    },\r\n\r\n    /**\r\n     * add new border style info. Used for add new style.\r\n     * @param {Object} info\r\n     * @param {Number} info.id\r\n     * @param {String} info.formatCode example  #,##0.00_ ;[Red]\\-#,##0.00\\\r\n     * @return {Number} index\r\n     */\r\n    add: function(info) {\r\n        var st = XLSX.csWorkbook;\r\n        info.formatCode = st.escapeXML(info.formatCode);\r\n        return this.callParent([info]);\r\n    },\r\n\r\n    compile: function(element){\r\n        if (element.formatCode){\r\n            this.compiled.push(['<numFmt numFmtId=\"', element.id, '\" formatCode=\"', element.formatCode, '\"/>'].join('') ); //this.tpl.apply(element)\r\n        }\r\n        else {\r\n            this.compiled.push('');\r\n        }\r\n    }\r\n\r\n\r\n});\r\n","if (UB.isServer){\r\n    // var Ext = require('Ext');\r\n  throw new Error('XLSX temporary unavailable on server side')\r\n}\r\n/**\r\n * Registred font styles\r\n */\r\nExt.define('XLSX.csStyleFont', {\r\n    extend: 'XLSX.csBaseStyleElement',\r\n\r\n\r\n    constructor: function(config) {\r\n      /*\r\n       <font>\r\n       <b/>\r\n       <sz val=\"11\"/>\r\n       <color theme=\"1\"/>\r\n       <name val=\"Calibri\"/>\r\n       <family val=\"2\"/>\r\n       <scheme val=\"minor\"/>\r\n       </font>\r\n         */\r\n        /*\r\n        this.tpl = Ext.create('Ext.XTemplate',\r\n            '<font>',\r\n            '<tpl if=\"bold == true\">',\r\n                '<b/>',\r\n            '</tpl>',\r\n            '<tpl if=\"shadow == true\">',\r\n                '<shadow/>',\r\n            '</tpl>',\r\n            '<tpl if=\"fontSize.length !== 0\">',\r\n                '<sz val=\"{fontSize}\"/>',\r\n            '</tpl>',\r\n            '<tpl if=\"color.length !== 0\">',\r\n                '<color ',\r\n                '<tpl foreach=\".\">',\r\n                    '{$}=\"{.}\"',\r\n                '</tpl>',\r\n                '/>',\r\n            '</tpl>',\r\n            '<tpl if=\"name.length !== 0\">',\r\n               '<name val=\"{name}\"/>',\r\n            '</tpl>',\r\n            '<tpl if=\"family.length !== 0\">',\r\n                '<family val=\"{family}\"/>',\r\n            '</tpl>',\r\n            '<tpl if=\"scheme.length !== 0\">',\r\n                '<scheme val=\"{scheme}\"/>',\r\n            '</tpl>',\r\n            '<tpl if=\"underline.length !== 0\">',\r\n                '<u val=\"{underline}\"/>',\r\n            '</tpl>',\r\n            '</font>'\r\n        );\r\n        this.tpl.compile();\r\n        */\r\n        return this.callParent([config]);\r\n    },\r\n\r\n    compileTemplate: function(element){\r\n        var out = [], xkey;\r\n        out.push('<font>');\r\n        if (element.bold === true){\r\n            out.push('<b/>');\r\n        }\r\n        if (element.shadow === true){\r\n            out.push('<shadow/>');\r\n        }\r\n        if (element.fontSize){\r\n            out.push('<sz val=\"', element.fontSize + '', '\"/>');\r\n        }\r\n        if (element.color){\r\n            out.push('<color ');\r\n            for( xkey in element.color ){\r\n                if (element.color.hasOwnProperty(xkey)){\r\n                    out.push( xkey, '=\"', element.color[xkey] ,'\" ');\r\n                }\r\n            }\r\n            out.push('/>');\r\n        }\r\n        if (element.name){\r\n            out.push('<name val=\"', element.name, '\"/>');\r\n        }\r\n        if (element.family){\r\n            out.push('<family val=\"', element.family, '\"/>');\r\n        }\r\n        if (element.scheme){\r\n            out.push('<scheme val=\"', element.scheme, '\"/>');\r\n        }\r\n        if (element.underline){\r\n            out.push('<underline val=\"', element.underline, '\"/>');\r\n        }\r\n        out.push('</font>');\r\n        return out.join('');\r\n    },\r\n\r\n    /**\r\n     * add new fill style info. Used for add new style.\r\n     * @param {Object} info\r\n     * @param {String} [info.name] (optional) Calibri\r\n     * @param {String} [info.charset] (optional)\r\n     * @param {Number} [info.fontSize] (optional)\r\n     * @param {Boolean} [info.bold] (optional)\r\n     * @param {Boolean} [info.shadow] (optional)\r\n     * @param {Number} [info.family] (optional) 0 - 14\r\n     * @param {String} [info.scheme] (optional)  none, major, minor\r\n     * @param {String} [info.underline] (optional) single, double, singleAccounting, doubleAccounting, none,\r\n     * @param {Object} [info.color] (optional)\r\n     * @param {String} [info.color.theme] (optional)\r\n     * @param {Number} [info.color.tint] (optional)\r\n     * @param {Number} [info.color.indexed] (optional)\r\n     * @return {Number} index\r\n     */\r\n    add: function(info) {\r\n        return this.callParent([info]);\r\n    }\r\n\r\n\r\n});\r\n\r\n","if (UB.isServer){\r\n    // var Ext = require('Ext');\r\n  throw new Error('XLSX temporary unavailable on server side')\r\n}\r\n/**\r\n * Registred alignment styles\r\n */\r\nExt.define('XLSX.csStyleAlign', {\r\n    extend: 'XLSX.csBaseStyleElement',\r\n\r\n    constructor: function(config) {\r\n        return this.callParent([config]);\r\n    },\r\n\r\n\r\n    templateCompile: function(element){\r\n         var\r\n            prop, out = [];\r\n            out.push('<alignment ');\r\n            for( prop in element ){\r\n               if (element.hasOwnProperty(prop)){\r\n                   if (prop === 'id' || prop === 'code' || prop === 'code'){\r\n                       continue;\r\n                   }\r\n                   out.push( prop, '=\"', element[prop], '\" ');\r\n               }\r\n            }\r\n            out.push('/>');\r\n            return out.join('');\r\n    },\r\n\r\n    /**\r\n     * add new alignment style info. Used for add new style.\r\n     *\r\n     * info.type =  info.value\r\n     *\r\n     * horizontal = (general | left | center | right | fill | justify | centerContinuous | distributed)\r\n     * vertical = (top | center | bottom | justify distributed)\r\n     * textRotation  {Integer}\r\n     * wrapText {Boolean}\r\n     * indent {Integer}\r\n     * relativeIndent {Integer}\r\n     * justifyLastLine {Boolean}\r\n     * shrinkToFit {Boolean}\r\n     * readingOrder  {Integer}\r\n     *\r\n     * @param {Object} info\r\n     * @param {String} info.type\r\n     * @param {String} info.value\r\n     * @return {Number} index\r\n     */\r\n    add: function(info) {\r\n        return this.callParent([info]);\r\n    },\r\n\r\n    compile: function(element){\r\n            this.compiled.push(this.templateCompile(element));  //tpl.apply(element)\r\n    }\r\n\r\n\r\n});\r\n","if (UB.isServer){\r\n  throw new Error('XLSX temporary unavailable on server side')\r\n    // var Ext = require('Ext');\r\n}\r\n\r\n/**\r\n * Registred alignment styles\r\n */\r\nExt.define('XLSX.csStyleProtect', {\r\n    extend: 'XLSX.csBaseStyleElement',\r\n\r\n    constructor: function(config) {\r\n        /*\r\n        this.tpl = Ext.create('Ext.XTemplate',\r\n            '<protection ',\r\n            '<tpl foreach=\".\">',\r\n            '{% if (xkey == \"id\") continue; %}',\r\n            '{% if (xkey == \"code\") continue; %}',\r\n            '{% if (xkey == \"name\") continue; %}',\r\n            ' {$}=\"{.}\"',\r\n            '</tpl>',\r\n            '/>'\r\n        );\r\n        this.tpl.compile();\r\n        */\r\n        return this.callParent([config]);\r\n    },\r\n\r\n    compileTemplate: function(element){\r\n        var\r\n            out = [], xkey;\r\n        out.push('<protection>');\r\n        for( xkey in element ){\r\n            if (element.color.hasOwnProperty(xkey)){\r\n                if (xkey === 'id' || xkey === 'code' || xkey === 'code'){\r\n                    continue;\r\n                }\r\n                out.push( ' ', xkey, '=\"', element[xkey], '\" ');\r\n            }\r\n        }\r\n        out.push('/>');\r\n        return out.join('');\r\n    },\r\n\r\n    /**\r\n     * add new locked style info. Used for add new style.\r\n     *\r\n     * @param {Object} info\r\n     * @param {String} info.type locked, hidden\r\n     * @param {boolean} info.value\r\n     * @return {Number} index\r\n     */\r\n    add: function(info) {\r\n        return this.callParent([info]);\r\n    },\r\n\r\n    compile: function(element){\r\n            this.compiled.push(this.compileTemplate(element)); //tpl.apply(element)\r\n    }\r\n\r\n\r\n});\r\n\r\n","/*global XLSX */\n\nif (UB.isServer){\n  throw new Error('XLSX temporary unavailable on server side')\n  // var Ext = require('Ext');\n  // var JSZip = require('jsZip/jszip');\n}\n\n/**\n * Файл: XLSX.csWorksheet.js\n */\nExt.define('XLSX.csWorksheet', {\n\n    /**\n     *  @cfg {Object} margins\n     *  @cfg {Number} margins.left\n     *  @cfg {Number} margins.top\n     *  @cfg {Number} margins.right\n     *  @cfg {Number} margins.bottom\n     *  @cfg {Number} margins.header\n     *  @cfg {Number} margins.footer\n     *  all values are expressed in millimeters\n     */\n\n    constructor:function (config, workBook) {\n\t\tconfig = config || {};\n\t\tthis.workBook = workBook;\n\t\tthis.dataRows = [];\n\t\tthis.nextRowNum = 1;\n\t\tthis.columnProperies = \"\";\n\t\tthis.merge = [];\n\t\tthis.diapason = {\n\t\t\tminRowNum:0, minColNum:0, maxRowNum:0, maxColNum:0 };\n\n\t\tExt.applyIf(config, {\n\t\t\ttitle:\"Worksheet\", name:\"Лист\", setActive:false, table:null, id:1\n\t\t});\n\n\t\tExt.apply(this, config);\n\n\n\t\tif (this.name && this.name.length > 30 ){\n\t\t\tthis.name = this.name.substring(0, 30);\n\t\t}\n\t\t//Ext.ux.exporter.excelFormatter.Worksheet.superclass.constructor.apply(this, arguments);\n\t},\n\n\t/**\n\t * @private\n\t * @param context\n\t */\n\trender: function( context) {\n\t\tvar me = this, d = this.diapason, result = '',\n\t\t\tst = XLSX.csWorkbook;\n\n\t\td.minColNum = d.minColNum === 0 ? 1 : d.minColNum;\n\t\td.maxColNum = d.maxColNum === 0 ? 1 : d.maxColNum;\n\t\td.minRowNum = d.minRowNum === 0 ? 1 : d.minRowNum;\n\t\td.maxRowNum = d.maxRowNum === 0 ? 1 : d.maxRowNum;\n\n\t\tresult += '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">' +\n\t\t\t'<dimension ref=\"' + st.numAlpha(d.minColNum - (this.fixFirstColumn ? 1 : 0)) + d.minRowNum.toString() +\n\t\t\t':' + st.numAlpha(d.maxColNum - (this.fixFirstColumn ? 1 : 0)) + d.maxRowNum.toString() + '\"/><sheetViews><sheetView ' + (this.setActive ? 'tabSelected=\"1\" ' : '') +\n\t\t\t' workbookViewId=\"0\"/></sheetViews><sheetFormatPr defaultRowHeight=\"15\" />';\n\n\t\tresult += this.columnProperies + '<sheetData>';\n\n\t\tresult += this.dataRows.join('');\n\t\tresult += '</sheetData>';\n\n\t\tif (this.merge.length > 0){\n\t\t\tresult += '<mergeCells count=\"' + this.merge.length.toString() +  '\">' +\n\t\t\t\tthis.merge.join('') + '</mergeCells>';\n\t\t}\n\n\t\t// Отступы согласно https://enviance.softline.kiev.ua/confluence/pages/viewpage.action?pageId=70123712\n\t\t// 1 дюйм = 25.4 мм\n\t\tvar\n\t\t\tmm = 25.4,\n\t\t\tmargins = {\n\t\t\t\tleft: 20 ,\n\t\t\t\ttop: 10 ,\n\t\t\t\tright: 8 ,\n\t\t\t\tbottom: 8 ,\n\t\t\t\theader: 0,\n\t\t\t\tfooter: 0\n\t\t\t};\n\n        margins = _.defaults( me.margins || {}, margins);\n        margins.left = (margins.left || 0) / mm;\n        margins.top = (margins.top || 0) / mm;\n        margins.right = (margins.right || 0) / mm;\n        margins.bottom = (margins.bottom || 0) / mm;\n        margins.header = (margins.header || 0) / mm;\n        margins.footer = (margins.footer || 0) / mm;\n\n\t\tresult += '<pageMargins left=\"' + margins.left +\n\t\t\t'\" right=\"' + margins.right +\n\t\t\t'\" top=\"' + margins.top +\n\t\t\t'\" bottom=\"' + margins.bottom +\n\t\t\t'\" header=\"' + margins.header +\n\t\t\t'\" footer=\"' + margins.footer + '\" />';\n\t\tif (this.table) {\n\t\t\tresult += '<tableParts count=\"1\"><tablePart r:id=\"rId1\"/></tableParts>';\n\t\t}\n\n\t\t//worksheet properties\n\t\tresult += \"<pageSetup paperSize=\\\"9\\\" \";\n\n\t\t//page fitting\n\t\tif (this.worksheetScale !== null) {\n\t\t\tresult += \"scale=\\\"\" + this.worksheetScale + \"\\\" \";\n\t\t}\n\t\t//adds worksheet orientation\n\t\tif (this.orientation !== null) {\n\t\t\tresult += \"orientation=\\\"\" + this.orientation + \"\\\" \";\n\t\t}\n\t\t//worksheet page dpi\n\t\tresult += \"horizontalDpi=\\\"200\\\" verticalDpi=\\\"200\\\" />\";\n\n\t\tresult += '</worksheet>';\n\t\tcontext.xlWorksheets.file('sheet' + this.id + '.xml',result);\n\n\t\t/* todo : using table\n\t\t */\n\t\t/*\n         if (this.table) {\n         i = -1;\n         l = data[0].length;\n         t = st.numAlpha(data[0].length - 1) + data.length;\n         result = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><table xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" id=\"' + id\n         + '\" name=\"Table' + id + '\" displayName=\"Table' + id + '\" ref=\"A1:' + t + '\" totalsRowShown=\"0\"><autoFilter ref=\"A1:' + t + '\"/><tableColumns count=\"' + data[0].length + '\">';\n         while (++i < l) { result += '<tableColumn id=\"' + (i + 1) + '\" name=\"' + data[0][i] + '\"/>'; }\n         result += '</tableColumns><tableStyleInfo name=\"TableStyleMedium2\" showFirstColumn=\"0\" showLastColumn=\"0\" showRowStripes=\"1\" showColumnStripes=\"0\"/></table>';\n\n         context.xl.folder('tables').file('table' + this.id + '.xml', result);\n         context.xlWorksheets.folder('_rels').file('sheet' + this.id + '.xml.rels', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\"><Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table\" Target=\"../tables/table' + id + '.xml\"/></Relationships>');\n         contentTypes[1].unshift('<Override PartName=\"/xl/tables/table' + id + '.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\"/>');\n         }\n\t\t */\n\n\n\t\tcontext.contentTypes.unshift( '<Override PartName=\"/xl/worksheets/sheet' + this.id + '.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\"/>');\n\t\tcontext.props.unshift( st.escapeXML(this.name) || 'Sheet' + this.id);\n\t\tcontext.xlRels.unshift('<Relationship Id=\"rId' + this.id + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet' + this.id + '.xml\"/>');\n\t\tcontext.worksheets.unshift('<sheet name=\"' + (st.escapeXML(this.name) || 'Sheet' + this.id) + '\" sheetId=\"' + this.id + '\" r:id=\"rId' + this.id + '\"/>');\n\n\t},\n\n\t/**\n\t * Return current row number. First row index is 1.\n\t * @return {Number}\n\t */\n\tgetRowNum: function(){\n\t\treturn this.nextRowNum;\n\t},\n\n\t/**\n\t * Set position of current row. Current row number can only increase. 1,2,3,25,26 ....\n\t * First row index is 1.\n\t * @param rowNum\n\t * @return {Number}\n\t */\n\tsetRowNum: function(rowNum){\n\t\tthis.checkRowNum(rowNum);\n\t\tif (rowNum > this.nextRowNum){\n\t\t\tthis.nextRowNum = rowNum;\n\t\t}\n\t\treturn this.nextRowNum;\n\t},\n\n\t/*\n\t * Old description:\n\t * @param {Object} config.value type of Object must be in (string, boolean, date)\n\t * @param {string} config.formula\n\t * @param {Number} config.style style index for get call  WorkBook.style.add(config)\n\t * @param {Number} config.column column num\n\t */\n\n\t/**\n\t * Add next row to Worksheet. Current row number can only increase.\n\t * For change the current row number, use {@link XLSX.csWorksheet#setRowNum}\n\t *\n\t * @param {Array} config array of cells\n     * @param {Object} config.value type of Object must be in (string, boolean, date)\n     * @param {string} config.formula\n     * @param {Number} config.style style index for get call  WorkBook.style.add(congig)\n     * @param {Number} config.column column num\n\t * @param {Array} [template] (optional) options for apply to config\n\t * @param {Object} [rowConfig] (optional)\n\t * @param {Object} [rowConfig.height] (optional)\n\t * @return {Number}\n\t */\n\taddRow: function(config, template, rowConfig ){\n\n\t\tvar st = XLSX.csWorkbook,\n\t\t\ttype, valAsTagIs = false,\n\t\t\tuseSharedString = this.workBook.useSharedString;\n\n\t\tif (Ext.isDefined(template) && !Ext.isArray(template) ){\n\t\t\ttemplate = undefined;\n\t\t}\n\n\t\tif (Ext.isArray(template) && template[0] !== undefined && template[0].width !== undefined) {\n\t\t\tif (this.numberColumnsWidth !== undefined) {\n\t\t\t\tif (template.length > this.numberColumnsWidth) {\n\t\t\t\t\tthis.numberColumnsWidth = template.length;\n\t\t\t\t\tthis.setColsProperties(template);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.numberColumnsWidth = template.length;\n\t\t\t\tthis.setColsProperties(template);\n\t\t\t}\n\t\t}\n\n\t\trowConfig = rowConfig || {};\n\t\trowConfig.columnsSpan = rowConfig.columnsSpan || 1;\n\n\t\tthis.checkRowNum(this.nextRowNum);\n\n\t\t//Будем считать кол-во строк\n\t\tif (!this.rowsCount) {\n\t\t\tthis.rowsCount = 1;\n\t\t} else {\n\t\t\tthis.rowsCount++;\n\t\t}\n\n\t\tthis.dataRows.push(\"<row r=\\\"\" + this.nextRowNum.toString() + \"\\\" \");\n\t\tif (rowConfig.height) {\n\t\t\tthis.dataRows.push(\"ht=\\\"\" + rowConfig.height.toString() + \"\\\" customHeight=\\\"1\\\" \");\n\t\t}\n\n\t\tthis.dataRows.push(\"> \"); //+ '\" x14ac:dyDescent=\"0.25\">';\n\n\t\tvar cellCount = 0;\n\n\t\tExt.Array.each(config, function(cell, index){\n\n\t\t\tcellCount++;\n\t\t\ttype = undefined;\n\t\t\tvalAsTagIs = false;\n\t\t\t//if (!Ext.isDefined(cell.value)){\n\t\t\t//    return true;\n\t\t\t//}\n\t\t\tif (Ext.isDefined(template) && Ext.isDefined(template[index])) {\n\t\t\t\tcell = Ext.applyIf(cell, template[index] );\n\t\t\t}\n\t\t\tthis.checkColNum(cell.column);\n\t\t\tif (typeof(cell.value) === 'string' ){\n\t\t\t\t// Ext.String.htmlEncode\n\t\t\t\tif (useSharedString)\n\t\t\t\t{\n\t\t\t\t\tcell.value =  this.workBook.addString(cell.value);\n\t\t\t\t\ttype = 's';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tcell.value =  st.escapeXML(cell.value);\n\t\t\t\t\tvalAsTagIs = true;\n\t\t\t\t\ttype = 'inlineStr';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if( typeof(cell.value) === 'boolean' ){\n\t\t\t\tcell.value = (cell.value ? 1 : 0);\n\t\t\t\ttype = 'b';\n\t\t\t}\n\t\t\telse if (Ext.isDate(cell.value)) {\n\t\t\t\tcell.value = st.convertDate(cell.value);\n\t\t\t\tif (!cell.style){\n\t\t\t\t\tcell.style = this.workBook.style.getDefDateStyle();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.diapason.minColNum === 0){\n\t\t\t\tthis.diapason.minColNum = cell.column;\n\t\t\t}\n\t\t\tif (this.diapason.maxColNum < cell.column){\n\t\t\t\tthis.diapason.maxColNum = cell.column;\n\t\t\t}\n\t\t\tthis.dataRows.push(\n\t\t\t\t\t'<c r=\"' + st.numAlpha(cell.column - (this.fixFirstColumn ? 1 : 0)) + this.nextRowNum.toString() + '\"' +\n\t\t\t\t\t(cell.style ? ' s=\"' + cell.style + '\"' : '') +\n\t\t\t\t\t(type ? ' t=\"' + type + '\"' : '') +\n\t\t\t\t\t'>' +\n\t\t\t\t\t(cell.formula ? '<f>' + cell.formula + '</f>' : '') +\n\t\t\t\t\t(Ext.isDefined(cell.value) && (cell.value !== null)  ? (valAsTagIs ? '<is><t>' + cell.value + '</t></is>' : '<v>' + cell.value + '</v>' ) : '' ) +\n\t\t\t\t\t'</c>'\n\t\t\t);\n\n\n            if (cell.cellStyle){\n                if (cell.cellStyle.rowSpan > 1) {\n                    this.addMerge({\n                        colFrom: cellCount,\n                        rowFrom: this.rowsCount,\n                        colTo: cellCount,\n                        rowTo: this.rowsCount + cell.cellStyle.rowSpan - 1\n                    });\n                }\n                //colSpan\n                if (cell.cellStyle.colSpan > 1) {\n                    this.addMerge({\n                        colFrom: cellCount,\n                        rowFrom: this.rowsCount,\n                        colTo: cellCount + cell.cellStyle.colSpan - 1,\n                        rowTo: this.rowsCount\n                    });\n                }\n            }\n\n\t\t},this);\n\n\t\tif (this.diapason.minRowNum === 0){\n\t\t\tthis.diapason.minRowNum = this.nextRowNum;\n\t\t}\n\t\tthis.diapason.maxRowNum = this.nextRowNum;\n\n\t\tthis.dataRows.push('</row>');\n\t\tvar res = this.nextRowNum;\n\t\tthis.nextRowNum++;\n\t\treturn res;\n\t},\n\n\t/**\n\t * setup column properties\n\t * @param {Object} config array [{column: 1, width: 200},{colnum: 2, width: 20}]\n\t */\n\tsetColsProperties: function(config){\n\t\tvar res = [];\n\t\t//this.columnProperties\n\t\tres.push('<cols>');\n\t\tExt.Array.each(config, function(column ){\n\t\t\tcolumn.column = this.checkColNum(column.column);\n\t\t\tres.push('<col min=\"');\n\t\t\tres.push( column.column.toString() ); //TODO: Индекс колонки с шириной\n\t\t\tres.push('\" max=\"');\n\t\t\tres.push( column.column.toString() );\n\t\t\tres.push('\" width=\"');\n\t\t\tres.push (column.width.toString() );\n\t\t\tres.push('\" customWidth=\"1\"/>');\n\t\t},this);\n\t\tres.push('</cols>');\n\t\tthis.columnProperies = res.join('');\n\t},\n\n\t/**\n\t * check value is number and in diapason 1 .. 65535\n\t * @param {Object} value must be number\n\t * @return {Number}\n\t */\n\tcheckRowNum: function(value){\n\t\tif (Ext.isNumber(value) && (value >= 0) && (value < 1048576) ){\n\t\t\treturn value;\n\t\t}\n\t\tthrow new Error('Value is not row number');\n\t},\n\n\t/**\n\t * check value is number and in diapason 1 .. 256\n\t * @param value\n\t * @return {*}\n\t */\n\tcheckColNum: function(value){\n\t\tif (Ext.isNumber(value) && (value >= 0) && (value < 16384) ){\n\t\t\treturn value;\n\t\t}\n\t\tthrow new Error('Value is not column number');\n\t},\n\n\t/**\n\t *  add Merge for cells\n\t *  @param {Object} config\n\t *  @param {Number} config.colFrom\n\t *  @param {Number} config.rowFrom\n\t *  @param {Number} config.colTo\n\t *  @param {Number} config.rowTo\n\t */\n\taddMerge: function(config){\n\t\tvar st = XLSX.csWorkbook;\n\t\tconfig = config || {};\n\t\tconfig.colFrom = this.checkColNum(config.colFrom);\n\t\tconfig.rowFrom = this.checkRowNum(config.rowFrom || this.nextRowNum);\n\t\tconfig.colTo = this.checkColNum(config.colTo);\n\t\tconfig.rowTo =this.checkRowNum(config.rowTo || this.nextRowNum);\n\n\t\tthis.merge.push('<mergeCell ref=\"' + st.numAlpha(config.colFrom - (this.fixFirstColumn ? 1 : 0)) + config.rowFrom +\n\t\t\t\":\" + st.numAlpha(config.colTo - (this.fixFirstColumn ? 1 : 0)) + config.rowTo + '\"/>' );\n        /*\n         <mergeCells count=\"3\">\n         <mergeCell ref=\"A1:A3\"/>\n         <mergeCell ref=\"A4:B5\"/>\n         <mergeCell ref=\"A6:B6\"/>\n         </mergeCells>\n\t\t */\n\t},\n\n\t/**\n\t * Worksheet orientation\n\t */\n\torientation: null,\n\t/**\n\t * Sets worksheet orientation\n\t * @param {string} orientation (portrait || landscape)\n\t */\n\tsetOrientation: function (orientation) {\n\t\tthis.orientation = orientation;\n\t},\n\n\t/**\n\t * Scale of worksheet when printing\n\t */\n\tworksheetScale: null,\n\t/**\n\t *\n\t * @param {Int} scale\n\t */\n\tsetWorksheetScale: function(scale) {\n\t\tthis.worksheetScale = scale;\n\t},\n\n\t/**\n\t * Fix for unfilling first column\n\t */\n\tfixFirstColumn: false,\n\t/**\n\t * Setting up for fix first column\n\t */\n\tsetFixForFirstColumn: function() {\n\t\tthis.fixFirstColumn = true;\n\t}\n\n});","/*global XLSX,JSLibs,saveAs,require,writeFile */\n//@require ../../../modules/jsZip/jszip.min.js\n\nif (UB.isServer){\n  throw new Error('XLSX temporary unavailable on server side')\n    // var Ext = require('Ext');\n    // var JSZip = require('jsZip\\\\jszip');\n}\n\nExt.define('XLSX.csWorkbook', {\n\n\t\tstatics:{\n\t\t\tnumFmts:['General', '0', '0.00', '#,##0', '#,##0.00', , , , , '0%', '0.00%', '0.00E+00', '# ?/?', '# ??/??', 'mm-dd-yy', 'd-mmm-yy', 'd-mmm', 'mmm-yy', 'h:mm AM/PM', 'h:mm:ss AM/PM',\n\t\t\t\t'h:mm', 'h:mm:ss', 'm/d/yy h:mm', , , , , , , , , , , , , , , '#,##0 ;(#,##0)', '#,##0 ;[Red](#,##0)', '#,##0.00;(#,##0.00)', '#,##0.00;[Red](#,##0.00)', , , , , 'mm:ss', '[h]:mm:ss', 'mmss.0', '##0.0E+0', '@'], alphabet:'ABCDEFGHIJKLMNOPQRSTUVWXYZ', numAlpha:function (i) {\n\t\t\t\tvar t = Math.floor(i / 26) - 1;\n\t\t\t\treturn (t > -1 ? this.numAlpha(t) : '') + this.alphabet.charAt(i % 26);\n\t\t\t}, alphaNum:function (s) {\n\t\t\t\tvar t = 0;\n\t\t\t\tif (s.length === 2) {\n\t\t\t\t\tt = this.alphaNum(s.charAt(0)) + 1;\n\t\t\t\t}\n\t\t\t\treturn t * 26 + this.alphabet.indexOf(s.substr(-1));\n\t\t\t}, convertDate:function (input) {\n\t\t\t\treturn typeof input === 'object' ?\n\t\t\t\t\t((input - (Date.UTC(1900,0,0) + input.getTimezoneOffset() * 60000)) / 86400000) + 1 :\n\t\t\t\t\tnew Date(+(Date.UTC(1900,0,0) + input.getTimezoneOffset() * 60000) + (input - 1) * 86400000);\n\n\t\t\t}, typeOf:function (obj) {\n\t\t\t\treturn ({}).toString.call(obj).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();\n\t\t\t}, getAttr:function (s, n) {\n\t\t\t\ts = s.substr(s.indexOf(n + '=\"') + n.length + 2);\n\t\t\t\treturn s.substring(0, s.indexOf('\"'));\n\t\t\t},\n\t\t\tescapeXML: function(s) {\n\t\t\t\treturn (s || '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;').replace(/'/g, '&#x27;');\n\t\t\t}, // see http://www.w3.org/TR/xml/#syntax\n\t\t\tunescapeXML: function(s) {\n\t\t\t\treturn (s || '').replace(/&amp;/g, '&').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '\"').replace(/&#x27;/g, '\\'');\n\t\t\t}\n\n        },\n\n\t\tconstructor: function(config) {\n\t\t\tconfig = config || {};\n\n\t\t\tExt.apply(this, config, {\n\t\t\t\ttitle: \"Workbook\",\n\t\t\t\tfileCreator : \"UB\",\n\t\t\t\tlastModifiedBy: \"UB\",\n\t\t\t\tfileCreated : new Date(),\n\t\t\t\tfileModified : new Date(),\n\t\t\t\tuseSharedString : false,\n\t\t\t\twindowHeight    : 9000,\n\t\t\t\twindowWidth     : 50000,\n\t\t\t\tprotectStructure: false,\n\t\t\t\tprotectWindows  : false\n\t\t\t});\n\n\t\t\tthis.worksheets = [];\n\t\t\tthis.compiledWorksheets = [];\n\t\t\tthis.sharedStrings  = {};\n\t\t\tthis.sharedStringsArr  = [];\n\t\t\tthis.sharedStringIndex = 0;\n\t\t\tthis.sharedStringTotal = 0;\n\t\t\t//toLog('create XLSX.csStyle');\n\t\t\tthis.style = new XLSX.csStyle();\n\t\t\t//toLog('created XLSX.csStyle');\n\t\t},\n\n\t\taddWorkSheet: function(config){\n\t\t\tconfig.id = this.worksheets.length + 1;\n\t\t\tvar ws = new XLSX.csWorksheet(config, this);\n\t\t\tthis.worksheets.push(ws);\n\t\t\treturn ws;\n\t\t},\n\n\t\taddString: function(value){\n\t\t\tvar st = XLSX.csWorkbook,\n\t\t\t\tval = st.escapeXML(value),\n\t\t\t\tindex = this.sharedStrings[val];\n\t\t\tthis.sharedStringTotal++;\n\t\t\tif (!index) {\n\t\t\t\tindex = this.sharedStrings[val] = this.sharedStringIndex;\n\t\t\t\tthis.sharedStringIndex++;\n\t\t\t\tthis.sharedStringsArr.push(val);\n\t\t\t}\n\t\t\treturn index;\n\t\t},\n\n\t\trender: function() {\n\t\t\tvar zip = this.zip = new JSZip(),\n\t\t\t\txl, xlWorksheets, context;\n\n\t\t\t//{ Fully static\n\t\t\tzip.folder('_rels').file('.rels', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\"><Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Target=\"docProps/app.xml\"/><Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Target=\"docProps/core.xml\"/><Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/></Relationships>');\n\t\t\tthis.docProps = zip.folder('docProps');\n\n\t\t\txl = zip.folder('xl');\n\t\t\txl.folder('theme').file('theme1.xml', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Cambria\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"ＭＳ Ｐゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"宋体\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"MS P????\"/><a:font script=\"Hang\" typeface=\"?? ??\"/><a:font script=\"Hans\" typeface=\"??\"/><a:font script=\"Hant\" typeface=\"????\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:shade val=\"51000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"80000\"><a:schemeClr val=\"phClr\"><a:shade val=\"93000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"94000\"/><a:satMod val=\"135000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>');\n\t\t\txlWorksheets = xl.folder('worksheets');\n\t\t\t//}\n\t\t\t//{ Not content dependent\n\t\t\tthis.docProps.file('core.xml', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"><dc:creator>' +\n\t\t\t\t\t(this.fileCreator) + '</dc:creator><cp:lastModifiedBy>' + (this.lastModifiedBy || 'UB') + '</cp:lastModifiedBy><dcterms:created xsi:type=\"dcterms:W3CDTF\">' +\n\t\t\t\t\t(this.fileCreated).toISOString() + '</dcterms:created><dcterms:modified xsi:type=\"dcterms:W3CDTF\">' + (this.fileModified ).toISOString() + '</dcterms:modified></cp:coreProperties>'\n\t\t\t);\n\t\t\t//}\n\n\t\t\tcontext = { xlWorksheets: xlWorksheets, xl: xl  };\n\t\t\tthis.compileWorksheets(context);\n\n\t\t\txl.file('styles.xml', this.style.render(context) );\n\n\t\t\t//{ [Content_Types].xml\n\t\t\tzip.file('[Content_Types].xml', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\"><Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/><Default Extension=\"xml\" ContentType=\"application/xml\"/><Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\"/>' +\n\t\t\t\tcontext.contentTypes.join('') + '<Override PartName=\"/xl/theme/theme1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\"/><Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\"/><Override PartName=\"/xl/sharedStrings.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\"/>' +\n\t\t\t\tcontext.contentTypesTab.join('') + '<Override PartName=\"/docProps/core.xml\" ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\"/><Override PartName=\"/docProps/app.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.extended-properties+xml\"/></Types>');\n\t\t\t//}\n\t\t\t//{ docProps/app.xml\n\t\t\tthis.docProps.file('app.xml',\n\t\t\t\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\"><Application>UB</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size=\"2\" baseType=\"variant\"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>' +\n\t\t\t\t\tthis.worksheets.length + '</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size=\"' +\n\t\t\t\t\tcontext.props.length + '\" baseType=\"lpstr\"><vt:lpstr>' +\n\t\t\t\t\tcontext.props.join('</vt:lpstr><vt:lpstr>') +\n\t\t\t\t\t'</vt:lpstr></vt:vector></TitlesOfParts><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>1.0</AppVersion></Properties>');\n\t\t\t//}\n\t\t\t//{ xl/_rels/workbook.xml.rels\n\t\t\txl.folder('_rels').file('workbook.xml.rels', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' +\n\t\t\t\tcontext.xlRels.join('') + '<Relationship Id=\"rId' + (context.xlRels.length + 1) + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\" Target=\"sharedStrings.xml\"/>' +\n\t\t\t\t'<Relationship Id=\"rId' + (context.xlRels.length + 2) + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>' +\n\t\t\t\t'<Relationship Id=\"rId' + (context.xlRels.length + 3) + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"theme/theme1.xml\"/></Relationships>');\n\t\t\t//}\n\t\t\t//{ xl/sharedStrings.xml\n\t\t\txl.file('sharedStrings.xml', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"' +\n\t\t\t\tthis.sharedStringTotal + '\" uniqueCount=\"' + this.sharedStringsArr.length + '\"><si><t>' +\n\t\t\t\tthis.sharedStringsArr.join('</t></si><si><t>') + '</t></si></sst>');\n\t\t\t//}\n\t\t\t//{ xl/workbook.xml\n\t\t\txl.file('workbook.xml', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">' +\n\t\t\t\t'<fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"9303\"/><workbookPr defaultThemeVersion=\"124226\"/><bookViews><workbookView ' +\n\t\t\t\t(this.activeWorksheet ? 'activeTab=\"' + this.activeWorksheet + '\" ' : '') +\n\t\t\t\t'xWindow=\"480\" yWindow=\"60\" windowWidth=\"18195\" windowHeight=\"8505\"/></bookViews><sheets>' +\n\t\t\t\tcontext.worksheets.join('') + '</sheets><calcPr calcId=\"145621\"/></workbook>');\n\t\t\t//}\n\n      return zip.generateAsync({type:\"string\",  compression : this.compression})\n\t\t},\n\n\t\t/**\n\t\t * Compression for workbook\n\t\t */\n\t\tcompression: 'STORE',\n\t\t/**\n\t\t * Setting up custom compression for workbook\n\t\t * @param {String} compression (\"DEFLATE\" || \"STORE\")\n\t\t */\n\t\tsetCompression: function(compression) {\n\t\t\tthis.compression = compression;\n\t\t},\n\n\t\tcompileWorksheets: function(context) {\n\t\t\tcontext.contentTypes = [];\n\t\t\tcontext.contentTypesTab = [];\n\t\t\tcontext.props = [];\n\t\t\tcontext.xlRels = [];\n\t\t\tcontext.worksheets = [];\n\n\n\t\t\tExt.each(this.worksheets, function(worksheet) {\n\t\t\t\tworksheet.render(context);\n\t\t\t}, this);\n\t\t},\n\n\t\ttest: function(){\n\t\t\t/*\n             <font>\n             <b/>\n             <sz val=\"11\"/>\n             <color theme=\"1\"/>\n             <name val=\"Calibri\"/>\n             <family val=\"2\"/>\n             <scheme val=\"minor\"/>\n             </font>\n             */\n\t\t\tvar wb = this;\n\t\t\twb.useSharedString = false;\n\t\t\tvar defFont = this.style.fonts.add({code: 'def',  name: 'Calibri', fontSize: 11, scheme: \"minor\" });\n\t\t\tvar borderFull =  wb.style.borders.add({left: {style: 'thin'}, right: {style: 'thin'}, top: {style: 'thin'}, bottom: {style: 'thin'} });\n\n\t\t\tvar fstyle  = this.style.getStyle({font: defFont});\n\t\t\tvar fstyleborderFull  = this.style.getStyle({font: defFont, border: borderFull});\n\t\t\t// this.style.fonts.named.def\n\t\t\tvar ws = wb.addWorkSheet({});\n\t\t\tvar columnTemplate = [\n\t\t\t\t{column: 1, style: fstyle },\n\t\t\t\t{column: 3, style: fstyle },\n\t\t\t\t{column: 4, style: fstyleborderFull }\n\t\t\t];\n\t\t\tws.addRow([{value: \"test\"},{value: \"2\"}, {value: 256}], columnTemplate);\n\t\t\tws.addRow([{value: \"test\"},{value: \"2\"}, {value: 256}], columnTemplate);\n\t\t\tws.addRow([{value: \"test\"},{value: \"2\"}, {value: 256}], columnTemplate);\n\t\t\tif (!UB.isServer){\n\t\t\t\tvar rData = \"data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,\" + wb.render();\n\t\t\t\twindow.open(rData);\n\t\t\t} else {\n\t\t\t\tvar res = wb.render(); // btoa(wb.render());\n\t\t\t\ttoLog('write file D:\\\\m3\\\\Work\\\\xlsx\\\\test000.xlsx');\n\t\t\t\twriteFile('D:\\\\m3\\\\Work\\\\xlsx\\\\test000.xlsx', res, false);\n\n\t\t\t}\n\t\t}\n\n\n});\n"]}